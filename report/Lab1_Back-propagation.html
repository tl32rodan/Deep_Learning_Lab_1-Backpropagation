<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Lab1 : Back-propagation - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @charset "UTF-8";@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-published-note{color:#337ab7}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true" style="font-size: 19.2px !important; line-height: 28.8px !important;"><style>
.blue {
    color: #18AEF9;
}
.yellow{
    color: #F9EC18;
}
.green{
    color: #3EDA10;
}
.red{
    color: red;
}
</style><h1 id="Lab1--Back-propagation" data-id="Lab1--Back-propagation"><a class="anchor hidden-xs" href="#Lab1--Back-propagation" title="Lab1--Back-propagation"><span class="octicon octicon-link"></span></a><span>Lab1 : Back-propagation</span></h1><p><span>contributed by &lt; </span><code>tl32rodan</code><span> &gt;</span></p><h2 id="Introduction" data-id="Introduction"><a class="anchor hidden-xs" href="#Introduction" title="Introduction"><span class="octicon octicon-link"></span></a><span>Introduction</span></h2><ul>
<li><span>Deep learning technique is trending nowadays. One of the reasons being powerful is the </span><em><strong><span>gradient-based optimization</span></strong></em><span>.</span></li>
</ul><blockquote>
<p><span>Most deep learning algorithms involve optimization of some sort. Optimization</span><br>
<span>refers to the task of either minimizing or maximizing some function </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-246-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-4" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-5" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-6" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-246">f(x)</script></span><span> by altering</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-247-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-7" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-8" class="mjx-mrow"><span id="MJXc-Node-9" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-247">x</script></span><span>. </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-248-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2026;</mo></math>" role="presentation"><span id="MJXc-Node-10" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-11" class="mjx-mrow"><span id="MJXc-Node-12" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.318em;">…</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-248">\dots</script></span><span> We can reduce </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-249-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-13" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-14" class="mjx-mrow"><span id="MJXc-Node-15" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-16" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-17" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-18" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-249">f(x)</script></span><span> by moving </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-250-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-19" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-20" class="mjx-mrow"><span id="MJXc-Node-21" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-250">x</script></span><span> in small steps with opposite sign of the derivative. This technique is called </span><strong><span>gradient descent</span></strong><span>.</span><br>
<span>– </span><a href="https://www.deeplearningbook.org/" target="_blank" rel="noopener"><em><span>Deep Learning</span></em></a><span>,  Goodfellow et-al., MIT Press, 2016. </span><em><span>Section 4.3</span></em></p>
</blockquote><ul>
<li><span>To have a comprehensive knowledge of gradient-based optimization, this lab is for the purpose of implementing backpropagation of a simple two-layered feedforward network without using deep learning frameworks.</span></li>
</ul><h3 id="Lab-Objective" data-id="Lab-Objective"><a class="anchor hidden-xs" href="#Lab-Objective" title="Lab-Objective"><span class="octicon octicon-link"></span></a><span>Lab Objective</span></h3><ul>
<li><span>The purpose of this lab is to understand and implement simple neural networks with </span><mark><span>forwarding pass</span></mark><span> and </span><mark><span>backpropagation</span></mark><span> using two hidden layers.</span></li>
<li><span>Only Numpy and the python standard libraries are available, </span><mark><span>any other framework (ex : Tensorflow、PyTorch) is not allowed</span></mark><span> in this lab.</span></li>
</ul><h3 id="Requirements" data-id="Requirements"><a class="anchor hidden-xs" href="#Requirements" title="Requirements"><span class="octicon octicon-link"></span></a><span>Requirements</span></h3><ul>
<li><span>Implement simple neural networks with two hidden layers.</span></li>
<li><span>Use backpropagation in this neural network and can only use Numpy and other python standard libraries to implement.</span></li>
<li><span>Plot comparison figure that show the predict result and the ground-truth</span></li>
</ul><h2 id="Experiment-Setups" data-id="Experiment-Setups"><a class="anchor hidden-xs" href="#Experiment-Setups" title="Experiment-Setups"><span class="octicon octicon-link"></span></a><span>Experiment Setups</span></h2><h3 id="Sigmoid-functions" data-id="Sigmoid-functions"><a class="anchor hidden-xs" href="#Sigmoid-functions" title="Sigmoid-functions"><span class="octicon octicon-link"></span></a><span>Sigmoid functions</span></h3><h4 id="Activation-function" data-id="Activation-function"><a class="anchor hidden-xs" href="#Activation-function" title="Activation-function"><span class="octicon octicon-link"></span></a><span>Activation function</span></h4><ul>
<li><span>A layer of a feedforward network is just a </span><strong><span>linear model</span></strong><span> of input </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-251-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-22" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-23" class="mjx-mrow"><span id="MJXc-Node-24" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-251">x</script></span><span>:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-252-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>;</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-25" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-26" class="mjx-mrow"><span id="MJXc-Node-27" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.498em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-28" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-29" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-30" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.126em; padding-bottom: 0.539em;">;</span></span><span id="MJXc-Node-31" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">w</span></span><span id="MJXc-Node-32" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.539em;">,</span></span><span id="MJXc-Node-33" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">b</span></span><span id="MJXc-Node-34" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span><span id="MJXc-Node-35" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-36" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-37" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-38" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-39" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-40" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">+</span></span><span id="MJXc-Node-41" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>;</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-252">f(x;w,b) = w^Tx+b</script></span></li>
<li><span>If 2 linear layers form a network, then it is just another linear model, meaning that it’s still not able to solve </span><a href="https://medium.com/@jayeshbahire/the-xor-problem-in-neural-networks-50006411840b" target="_blank" rel="noopener"><span>XOR problem</span></a></li>
</ul><blockquote>
<p><span>Suppose the network now contains two functions chained together:</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-253-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo>=</mo><msup><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>;</mo><mi>W</mi><mo>,</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-42" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-43" class="mjx-mrow"><span id="MJXc-Node-44" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">h</span></span><span id="MJXc-Node-45" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-46" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-47" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.181em; padding-right: 0.071em;"><span id="MJXc-Node-48" class="mjx-texatom" style=""><span id="MJXc-Node-49" class="mjx-mrow"><span id="MJXc-Node-50" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-51" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span><span id="MJXc-Node-52" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span></span></span><span id="MJXc-Node-53" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-54" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-55" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.528em;">;</span></span><span id="MJXc-Node-56" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.318em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-57" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-58" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">c</span></span><span id="MJXc-Node-59" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo>=</mo><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo>;</mo><mi>W</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-253">h=f^{(1)}(x;W,c)</script></span><span>and </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-254-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><msup><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mo>;</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-60" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-61" class="mjx-mrow"><span id="MJXc-Node-62" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-63" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-64" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-65" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.181em; padding-right: 0.071em;"><span id="MJXc-Node-66" class="mjx-texatom" style=""><span id="MJXc-Node-67" class="mjx-mrow"><span id="MJXc-Node-68" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-69" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span><span id="MJXc-Node-70" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span></span></span><span id="MJXc-Node-71" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-72" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">h</span></span><span id="MJXc-Node-73" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.528em;">;</span></span><span id="MJXc-Node-74" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">w</span></span><span id="MJXc-Node-75" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-76" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span><span id="MJXc-Node-77" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>h</mi><mo>;</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-254">y=f^{(2)}(h;w,b)</script></span><span>,with the complete model being </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-255-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>;</mo><mi>W</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-78" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-79" class="mjx-mrow"><span id="MJXc-Node-80" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-81" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-82" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-83" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.528em;">;</span></span><span id="MJXc-Node-84" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.318em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-85" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-86" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">c</span></span><span id="MJXc-Node-87" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-88" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">w</span></span><span id="MJXc-Node-89" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-90" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span><span id="MJXc-Node-91" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-92" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-93" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-94" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.181em; padding-right: 0.071em;"><span id="MJXc-Node-95" class="mjx-texatom" style=""><span id="MJXc-Node-96" class="mjx-mrow"><span id="MJXc-Node-97" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-98" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span><span id="MJXc-Node-99" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span></span></span><span id="MJXc-Node-100" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-101" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-102" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.181em; padding-right: 0.071em;"><span id="MJXc-Node-103" class="mjx-texatom" style=""><span id="MJXc-Node-104" class="mjx-mrow"><span id="MJXc-Node-105" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-106" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span><span id="MJXc-Node-107" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span></span></span><span id="MJXc-Node-108" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-109" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-110" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-111" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>;</mo><mi>W</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-255">f(x;W,c,w,b) = f^{(2)}(f^{(1)}(x))</script></span><span>. </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-256-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2026;</mo></math>" role="presentation"><span id="MJXc-Node-112" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-113" class="mjx-mrow"><span id="MJXc-Node-114" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.318em;">…</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>…</mo></math></span></span><script type="math/tex" id="MathJax-Element-256">\dots</script></span><span> Ignoring the intercept terms for the moment, suppose </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-257-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>W</mi><mi>T</mi></msup><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-115" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-116" class="mjx-mrow"><span id="MJXc-Node-117" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-118" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.181em; padding-right: 0.071em;"><span id="MJXc-Node-119" class="mjx-texatom" style=""><span id="MJXc-Node-120" class="mjx-mrow"><span id="MJXc-Node-121" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-122" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span><span id="MJXc-Node-123" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span></span></span><span id="MJXc-Node-124" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-125" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-126" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-127" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-128" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-129" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.318em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-130" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-131" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>W</mi><mi>T</mi></msup><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-257">f^{(1)}(x) =W^Tx</script></span><span> and </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-258-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>h</mi><mi>T</mi></msup><mi>w</mi></math>" role="presentation"><span id="MJXc-Node-132" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-133" class="mjx-mrow"><span id="MJXc-Node-134" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-135" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.181em; padding-right: 0.071em;"><span id="MJXc-Node-136" class="mjx-texatom" style=""><span id="MJXc-Node-137" class="mjx-mrow"><span id="MJXc-Node-138" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-139" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span><span id="MJXc-Node-140" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span></span></span><span id="MJXc-Node-141" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-142" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">h</span></span><span id="MJXc-Node-143" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-144" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-145" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-146" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">h</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-147" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-148" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">w</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>h</mi><mi>T</mi></msup><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-258">f^{(2)}(h)=h^Tw</script></span><span>. Then </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-259-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>W</mi><mi>T</mi></msup><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-149" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-150" class="mjx-mrow"><span id="MJXc-Node-151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-152" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-153" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-154" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-155" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-156" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-157" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-158" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-159" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-160" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.318em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-161" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-162" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>W</mi><mi>T</mi></msup><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-259">f(x)=w^TW^Tx</script></span><span>. We could represent this function as </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-260-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>x</mi><mi>T</mi></msup><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi></mi><mo>&amp;#x2032;</mo></msup></mrow></msup></math>" role="presentation"><span id="MJXc-Node-163" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-164" class="mjx-mrow"><span id="MJXc-Node-165" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-166" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-167" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-168" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-169" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-170" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-171" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-172" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-173" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-174" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-175" class="mjx-texatom" style=""><span id="MJXc-Node-176" class="mjx-mrow"><span id="MJXc-Node-177" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-178" class="mjx-mi"></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-179" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.265em; padding-bottom: 0.318em;">′</span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mi>T</mi></msup><msup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi></mi><mo>′</mo></msup></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-260">f(x)=x^Tw^{'}</script></span><span>, where </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-261-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi></mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo>=</mo><mi>W</mi><mi>w</mi></math>" role="presentation"><span id="MJXc-Node-180" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-181" class="mjx-mrow"><span id="MJXc-Node-182" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-183" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-184" class="mjx-texatom" style=""><span id="MJXc-Node-185" class="mjx-mrow"><span id="MJXc-Node-186" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-187" class="mjx-mi"></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-188" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.265em; padding-bottom: 0.318em;">′</span></span></span></span></span></span></span></span><span id="MJXc-Node-189" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-190" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.318em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-191" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">w</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi></mi><mo>′</mo></msup></mrow></msup><mo>=</mo><mi>W</mi><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-261">w^{'}=Ww</script></span><span> – </span><a href="https://www.deeplearningbook.org/" target="_blank" rel="noopener"><em><span>Deep Learning</span></em></a><span>,  Goodfellow et-al., MIT Press, 2016. </span><em><span>Section 6.1</span></em></p>
</blockquote><ul>
<li><span>Activation function 能將 </span><em><strong><span>nonlinear</span></strong></em><span> 引入模型中, 使得模型能夠實現 nonlinear 的學習</span></li>
</ul><h4 id="Sigmoid-function" data-id="Sigmoid-function"><a class="anchor hidden-xs" href="#Sigmoid-function" title="Sigmoid-function"><span class="octicon octicon-link"></span></a><span>Sigmoid function</span></h4><ul>
<li>
<p><span>One of the most common activation functions</span><br>
<img src="https://kharshit.github.io/img/sigmoid.jpeg" alt="sigmoid function"></p>
</li>
<li>
<p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-262-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mstyle></math>" role="presentation"><span id="MJXc-Node-192" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-193" class="mjx-mrow"><span id="MJXc-Node-194" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-195" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-196" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-197" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span><span id="MJXc-Node-198" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-199" class="mjx-mstyle MJXc-space3"><span id="MJXc-Node-200" class="mjx-mrow"><span id="MJXc-Node-201" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 5.578em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 5.578em; top: -1.368em;"><span id="MJXc-Node-202" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.333em;">1</span></span></span><span class="mjx-denominator" style="width: 5.578em; bottom: -0.993em;"><span id="MJXc-Node-203" class="mjx-mrow"><span id="MJXc-Node-204" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.333em;">1</span></span><span id="MJXc-Node-205" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">+</span></span><span id="MJXc-Node-206" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.167em; padding-bottom: 0.539em;">exp</span></span><span id="MJXc-Node-207" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-208" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-209" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">−</span></span><span id="MJXc-Node-210" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-211" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 5.578em;" class="mjx-line"></span></span><span style="height: 2.361em; vertical-align: -0.993em;" class="mjx-vsize"></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-262">\sigma(x) = \dfrac{1}{1+\exp(-x)}</script></span></p>
<ul>
<li><span>Pros:</span>
<ul>
<li><span>能將 layer output </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-263-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-212" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-213" class="mjx-mrow"><span id="MJXc-Node-214" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-215" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-216" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-217" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-218" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">+</span></span><span id="MJXc-Node-219" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-263">w^Tx+b</script></span><span> 轉為 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-264-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span id="MJXc-Node-220" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-221" class="mjx-mrow"><span id="MJXc-Node-222" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">[</span></span><span id="MJXc-Node-223" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.374em;">0</span></span><span id="MJXc-Node-224" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.539em;">,</span></span><span id="MJXc-Node-225" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.333em;">1</span></span><span id="MJXc-Node-226" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-264">[0,1]</script></span><span> 之間的數值</span></li>
<li><span>處處可微; 代表將來做 </span><a href="https://hackmd.io/i9wkp1OZSsamwb7hJuO44w?view#Introduction" target="_blank" rel="noopener"><span>gradient decent</span></a><span> 時，不會遇到無法更新的情況</span></li>
<li><span>Sigmoid function 的微分為 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-265-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-227" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-228" class="mjx-mrow"><span id="MJXc-Node-229" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.916em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.295em; top: -1.302em;"><span id="MJXc-Node-230" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.003em;">d</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.295em; bottom: -0.596em;"><span id="MJXc-Node-231" class="mjx-mrow" style=""><span id="MJXc-Node-232" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-233" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 0.916em;" class="mjx-line"></span></span><span style="height: 1.342em; vertical-align: -0.421em;" class="mjx-vsize"></span></span><span id="MJXc-Node-234" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-235" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-236" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-237" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span><span id="MJXc-Node-238" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-239" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-240" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-241" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-242" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span><span id="MJXc-Node-243" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-244" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.333em;">1</span></span><span id="MJXc-Node-245" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">−</span></span><span id="MJXc-Node-246" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-247" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-248" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-249" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span><span id="MJXc-Node-250" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-265">\frac{d}{dx}\sigma(x)=\sigma(x)(1-\sigma(x))</script></span><span> ，所以在計算 backpropagation 時，有不錯的計算效率</span>
<ul>
<li><a href="https://math.stackexchange.com/questions/78575/derivative-of-sigmoid-function-sigma-x-frac11e-x" target="_blank" rel="noopener"><span>sigmoid function 微分推導</span></a></li>
</ul>
</li>
</ul>
</li>
<li><span>Cons:</span>
<ul>
<li><span>由於要計算 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-266-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-251" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-252" class="mjx-mrow"><span id="MJXc-Node-253" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.167em; padding-bottom: 0.539em;">exp</span></span><span id="MJXc-Node-254" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-255" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-256" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">−</span></span><span id="MJXc-Node-257" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-258" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-266">\exp(-x)</script></span><span>, 所以運算相對複雜</span></li>
<li><span>有 </span><strong><span class="red"><span>saturation problem</span></span></strong>
<blockquote>
<p><span>The sigmoid function </span><strong><span>saturates</span></strong><span> when its argument is very positive or very negative, meaning that the function becomes very flat and insensitive to small changes in its input – </span><a href="https://www.deeplearningbook.org/" target="_blank" rel="noopener"><em><span>Deep Learning</span></em></a><span>,  Goodfellow et-al., MIT Press, 2016. </span><em><span>Section 3.10</span></em></p>
</blockquote>
</li>
<li><span>Not zero-centered</span></li>
</ul>
</li>
</ul>
</li>
<li>
<p><span>實現</span></p>
</li>
</ul><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sigmoid</span><span class="hljs-params">(Layer)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
        self.y = <span class="hljs-keyword">None</span>
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">forward</span><span class="hljs-params">(self, x)</span>:</span>
        <span class="hljs-comment"># 計算 sigmoid(x)</span>
        self.y = <span class="hljs-number">1.0</span> /(<span class="hljs-number">1.0</span> + np.exp(-x))
        <span class="hljs-keyword">return</span> self.y
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">backward</span><span class="hljs-params">(self, prev_grad,lr=<span class="hljs-number">0.1</span>)</span>:</span>
        <span class="hljs-comment"># 計算 sigmoid(x) 的微分，並且做 backpropagation</span>
        <span class="hljs-keyword">return</span> prev_grad * np.multiply((<span class="hljs-number">1.0</span> - self.y) , self.y)
</code></pre><h3 id="Neural-network" data-id="Neural-network"><a class="anchor hidden-xs" href="#Neural-network" title="Neural-network"><span class="octicon octicon-link"></span></a><span>Neural network</span></h3><h4 id="Deep-feedforward-networks" data-id="Deep-feedforward-networks"><a class="anchor hidden-xs" href="#Deep-feedforward-networks" title="Deep-feedforward-networks"><span class="octicon octicon-link"></span></a><span>Deep feedforward networks</span></h4><ul>
<li><span>According to </span><em><strong><span>Chapeter 10</span></strong></em><span> of the book </span><a href="https://www.deeplearningbook.org/" target="_blank" rel="noopener"><em><strong><span>Deep Learning</span></strong></em></a><span>,  </span><strong><span>Goodfellow et-al.</span></strong></li>
</ul><blockquote>
<p><span>Deep feedforward networks, also often called </span><strong><span>feedforward neural networks</span></strong><span>, or </span><strong><span>multilayer perceptrons (MLPs)</span></strong><span>, are the quintessential deep learning models. The goal of a feedforward network is to approximate some function </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-267-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2217;</mo></mrow></msup></math>" role="presentation"><span id="MJXc-Node-259" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-260" class="mjx-mrow"><span id="MJXc-Node-261" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-262" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.181em; padding-right: 0.071em;"><span id="MJXc-Node-263" class="mjx-texatom" style=""><span id="MJXc-Node-264" class="mjx-mrow"><span id="MJXc-Node-265" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">∗</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>∗</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-267">f^{*}</script></span><span>. A feedforward network defines a mapping </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-268-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>;</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-266" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-267" class="mjx-mrow"><span id="MJXc-Node-268" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-269" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-270" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-271" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-272" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span><span id="MJXc-Node-273" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.528em;">;</span></span><span id="MJXc-Node-274" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">θ</span></span><span id="MJXc-Node-275" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>;</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-268">y = f(x; \theta)</script></span><span> and learns the value of the parameters </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-269-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><span id="MJXc-Node-276" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-277" class="mjx-mrow"><span id="MJXc-Node-278" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-269">\theta</script></span><span> that result in the best function approximation.</span><br>
<span>They are called </span><em><strong><span>feedforward</span></strong></em><span> because information </span><mark><span>flows through the function</span></mark><span> being evaluated from </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-270-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-279" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-280" class="mjx-mrow"><span id="MJXc-Node-281" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-270">x</script></span><span>, through the </span><mark><span>intermediate computations</span></mark><span> used to define </span><strong><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-271-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><span id="MJXc-Node-282" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-283" class="mjx-mrow"><span id="MJXc-Node-284" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-271">f</script></span></strong><span>, and finally to the output </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-272-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-285" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-286" class="mjx-mrow"><span id="MJXc-Node-287" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-272">y</script></span><span>. There are </span><strong><span>no feedback connections</span></strong><span> in which outputs of the model are fed back into itself.</span><br>
<span>When feedforward neural networks are extended to include feedback connections, they are called </span><strong><span>recurrent neural networks</span></strong></p>
</blockquote><h4 id="Implementing-Details" data-id="Implementing-Details"><a class="anchor hidden-xs" href="#Implementing-Details" title="Implementing-Details"><span class="octicon octicon-link"></span></a><span>Implementing Details</span></h4><p><img src="https://i.imgur.com/EoeJYPl.png" alt=""></p><ul>
<li><span>依據上面的架構圖，實現程式碼如下:</span></li>
</ul><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TLNN</span><span class="hljs-params">(object)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-comment"># 用 collection.OrderedDict 依序存放 layer</span>
        <span class="hljs-comment"># 以便於 forward &amp; backward呼叫</span>
        self.layers = OrderedDict()
        self.layers[<span class="hljs-string">'linear_1'</span>] = Linear(<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,bias=<span class="hljs-keyword">True</span>)
        self.layers[<span class="hljs-string">'sigmoid_1'</span>] = Sigmoid()
        self.layers[<span class="hljs-string">'linear_2'</span>] = Linear(<span class="hljs-number">4</span>,<span class="hljs-number">4</span>,bias=<span class="hljs-keyword">True</span>)
        self.layers[<span class="hljs-string">'sigmoid_2'</span>] = Sigmoid()
        self.layers[<span class="hljs-string">'output'</span>] = Linear(<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,bias = <span class="hljs-keyword">False</span>)
        self.layers[<span class="hljs-string">'sigmoid_3'</span>] = Sigmoid()
        
        self.loss_func = MSE()
        
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">forward</span><span class="hljs-params">(self, x)</span>:</span>
        <span class="hljs-comment"># 把計算的值"順向"傳遞 -&gt; "forward"</span>
        <span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> self.layers.values():
            x = layer.forward(x)
        <span class="hljs-keyword">return</span> x
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cal_loss</span><span class="hljs-params">(self, y, ground_truth)</span>:</span>
        <span class="hljs-comment"># 計算 loss</span>
        <span class="hljs-keyword">return</span> self.loss_func.forward(y,ground_truth)
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">backward</span><span class="hljs-params">(self,lr=<span class="hljs-number">0.05</span>)</span>:</span>
        dy = self.loss_func.backward()
        
        <span class="hljs-comment"># Reverse the layers list for easily conducting backward</span>
        back_layers = list(self.layers.values())
        back_layers.reverse()
        <span class="hljs-comment"># 把 gradient "逆向"傳遞 -&gt; "forward"</span>
        <span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> back_layers:
            dy = layer.backward(dy,lr=lr)
</code></pre><h4 id="說明" data-id="說明"><a class="anchor hidden-xs" href="#說明" title="說明"><span class="octicon octicon-link"></span></a><span>說明</span></h4><ul>
<li><span>Input 為二維的資料; output 僅為 </span><code>0</code><span> 或 </span><code>1</code></li>
<li><span>Hidden layers 皆為 </span><code>4</code><span> 個 units</span></li>
<li><span>Activation function 皆為 </span><a href="https://hackmd.io/i9wkp1OZSsamwb7hJuO44w#Sigmoid-function" target="_blank" rel="noopener"><span>sigmoid function</span></a></li>
<li><span>Loss function 採用 </span><mark><span>MSE(Mean Square Error)</span></mark>
<blockquote>
<p><span>In statistics, the mean squared error (MSE) or mean squared deviation (MSD) of an estimator (of a procedure for estimating an unobserved quantity) measures the average of the squares of the errors—that is, the average squared difference between the estimated values and the actual value. – </span><a href="https://en.wikipedia.org/wiki/Mean_squared_error" target="_blank" rel="noopener"><em><span>Wilipedia</span></em></a></p>
</blockquote>
</li>
<li><s><span>非常簡單</span></s></li>
</ul><h3 id="Backpropagation" data-id="Backpropagation"><a class="anchor hidden-xs" href="#Backpropagation" title="Backpropagation"><span class="octicon octicon-link"></span></a><span>Backpropagation</span></h3><ul>
<li><span>Definition:</span></li>
</ul><blockquote>
<p><span>The back-propagation algorithm </span><a href="http://www.cs.toronto.edu/~hinton/absps/naturebp.pdf" target="_blank" rel="noopener"><span>(Rumelhart et al., 1986a)</span></a><span>, often simply called</span><br>
<strong><span>backprop</span></strong><span>, allows the </span><mark><span>information</span></mark><span> from the cost to then flow backwards through</span><br>
<span>the network, in order to compute the gradient.</span><br>
<span>–  </span><a href="https://www.deeplearningbook.org/" target="_blank" rel="noopener"><em><span>Deep Learning</span></em></a><span>,  Goodfellow et-al., MIT Press, 2016. </span><em><span>Section 6.5</span></em></p>
</blockquote><ul>
<li>
<p><span>對於 backpropagation 的誤解</span></p>
<ol>
<li><span>Backpropagation </span><span class="red"><span>不是</span></span><span> neural network 的 learning algorithm</span>
<ul>
<li><span>back-propagation refers only to </span><mark><span>the method for computing the gradient</span></mark><span>, while another algorithm, such as stochastic gradient descent, is used to perform learning using this gradient.</span></li>
</ul>
</li>
<li><span>Backpropagation </span><span class="red"><span>不是</span></span><span> 只能用在 multi-layer neural network 上</span>
<ul>
<li><span>任何計算 gradient </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-273-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>x</mi></msub><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-288" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-289" class="mjx-mrow"><span id="MJXc-Node-290" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-291" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-292" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span></span></span><span id="MJXc-Node-293" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.498em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-294" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-295" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-296" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.539em;">,</span></span><span id="MJXc-Node-297" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.498em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-298" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi>x</mi></msub><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-273">\nabla_x f(x,y)</script></span><span>  for an arbitrary function </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-274-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><span id="MJXc-Node-299" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-300" class="mjx-mrow"><span id="MJXc-Node-301" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.498em; padding-right: 0.06em;">f</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-274">f</script></span><span> 的過程，皆可稱之。</span>
<ul>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-275-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-302" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-303" class="mjx-mrow"><span id="MJXc-Node-304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-275">x</script></span><span> is a set of variables whose derivatives are desired</span></li>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-276-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-305" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-306" class="mjx-mrow"><span id="MJXc-Node-307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.498em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-276">y</script></span><span> is an additional set of variables that are inputs to the function but whose derivatives are not required</span></li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p><span>實作想法</span></p>
<ul>
<li><span>對於每一層 layer of neural network, 都定義一個 memeber function </span><code>backward()</code></li>
<li><span>接收後面傳回來的 gradient </span><code>prev_grad</code><span> 為 input,</span></li>
<li><span>計算 weight </span><code>w</code><span> 的權重</span></li>
<li><span>回傳 gradient w.r.t 該 layer 的 input </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-277-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-308" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-309" class="mjx-mrow"><span id="MJXc-Node-310" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-277">x</script></span><span>, i.e. </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-278-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>x</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-311" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-312" class="mjx-mrow"><span id="MJXc-Node-313" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.905em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.694em; top: -1.598em;"><span id="MJXc-Node-314" class="mjx-mrow" style=""><span id="MJXc-Node-315" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-316" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-317" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-318" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-319" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.694em; bottom: -0.628em;"><span id="MJXc-Node-320" class="mjx-mrow" style=""><span id="MJXc-Node-321" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-322" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.905em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-278">\frac{\partial L(\theta)}{\partial x}</script></span><span>, 其中 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-279-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-323" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-324" class="mjx-mrow"><span id="MJXc-Node-325" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-326" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-327" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-328" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-279">L(\theta)</script></span><span> 為 loss function value</span></li>
<li><span>Example:</span></li>
</ul>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">backward</span><span class="hljs-params">(self, prev_grad, lr = <span class="hljs-number">0.1</span>)</span>:</span>
    <span class="hljs-string">'''
        Input:
            prev_grad: np.array that comes from "next" layers
            lr : Learning rate
    '''</span>
    <span class="hljs-comment"># Calculate gradient of w, and update it with (learning rate*gradient)</span>
    dw = np.dot(self.x.T,prev_grad)
    self.w -= lr * dw
    
    <span class="hljs-comment"># Update bias if needed. Gradient of bias is the element-sum of prev_grad </span>
    <span class="hljs-keyword">if</span> self.has_bias <span class="hljs-keyword">is</span> <span class="hljs-keyword">True</span>:
        db = np.sum(prev_grad,axis=<span class="hljs-number">0</span>)
        self.b -= lr * db   
    
    <span class="hljs-comment"># Return gradient that prpogate to next layer</span>
    <span class="hljs-keyword">return</span> np.dot(prev_grad,self.w.T)
</code></pre>
<ul>
<li><span>補充說明:</span>
<ul>
<li><span>若 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-280-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Y</mi><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-329" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-330" class="mjx-mrow"><span id="MJXc-Node-331" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-332" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-333" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-334" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-335" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">+</span></span><span id="MJXc-Node-336" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-280">Y = XW+b</script></span><span>, 則 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-281-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>X</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>X</mi></mrow></mfrac><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><msup><mi>W</mi><mi>T</mi></msup></math>" role="presentation"><span id="MJXc-Node-337" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-338" class="mjx-mrow"><span id="MJXc-Node-339" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.905em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.694em; top: -1.598em;"><span id="MJXc-Node-340" class="mjx-mrow" style=""><span id="MJXc-Node-341" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-342" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-343" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-344" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-345" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.694em; bottom: -0.628em;"><span id="MJXc-Node-346" class="mjx-mrow" style=""><span id="MJXc-Node-347" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-348" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.905em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span><span id="MJXc-Node-349" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-350" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.144em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.618em; top: -1.335em;"><span id="MJXc-Node-351" class="mjx-mrow" style=""><span id="MJXc-Node-352" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-353" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.182em;">Y</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.618em; bottom: -0.628em;"><span id="MJXc-Node-354" class="mjx-mrow" style=""><span id="MJXc-Node-355" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-356" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.144em;" class="mjx-line"></span></span><span style="height: 1.388em; vertical-align: -0.444em;" class="mjx-vsize"></span></span><span id="MJXc-Node-357" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.905em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.694em; top: -1.598em;"><span id="MJXc-Node-358" class="mjx-mrow" style=""><span id="MJXc-Node-359" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-360" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-361" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-362" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-363" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.694em; bottom: -0.628em;"><span id="MJXc-Node-364" class="mjx-mrow" style=""><span id="MJXc-Node-365" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-366" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.905em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span><span id="MJXc-Node-367" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-368" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.905em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.694em; top: -1.598em;"><span id="MJXc-Node-369" class="mjx-mrow" style=""><span id="MJXc-Node-370" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-371" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-372" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-373" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-374" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.694em; bottom: -0.628em;"><span id="MJXc-Node-375" class="mjx-mrow" style=""><span id="MJXc-Node-376" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-377" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.905em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span><span id="MJXc-Node-378" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.043em; padding-bottom: 0.333em;">⋅</span></span><span id="MJXc-Node-379" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.104em;"><span id="MJXc-Node-380" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.104em;">W</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span id="MJXc-Node-381" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.12em;">T</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac><mo>⋅</mo><msup><mi>W</mi><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-281">\frac{\partial L(\theta)}{\partial X} = \frac{\partial Y}{\partial X}\frac{\partial L(\theta)}{\partial Y} = \frac{\partial L(\theta)}{\partial Y} \cdot W^T</script></span></li>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-282-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>W</mi></mrow></mfrac><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mo>&amp;#x22C5;</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-382" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-383" class="mjx-mrow"><span id="MJXc-Node-384" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.905em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.694em; top: -1.598em;"><span id="MJXc-Node-385" class="mjx-mrow" style=""><span id="MJXc-Node-386" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-387" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-388" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-389" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-390" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.694em; bottom: -0.628em;"><span id="MJXc-Node-391" class="mjx-mrow" style=""><span id="MJXc-Node-392" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-393" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.104em;">W</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.905em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span><span id="MJXc-Node-394" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-395" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.283em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.814em; top: -1.335em;"><span id="MJXc-Node-396" class="mjx-mrow" style=""><span id="MJXc-Node-397" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-398" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.182em;">Y</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.814em; bottom: -0.628em;"><span id="MJXc-Node-399" class="mjx-mrow" style=""><span id="MJXc-Node-400" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-401" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.104em;">W</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.283em;" class="mjx-line"></span></span><span style="height: 1.388em; vertical-align: -0.444em;" class="mjx-vsize"></span></span><span id="MJXc-Node-402" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.905em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.694em; top: -1.598em;"><span id="MJXc-Node-403" class="mjx-mrow" style=""><span id="MJXc-Node-404" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-405" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-406" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-407" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-408" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.694em; bottom: -0.628em;"><span id="MJXc-Node-409" class="mjx-mrow" style=""><span id="MJXc-Node-410" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-411" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.905em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span><span id="MJXc-Node-412" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-413" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-414" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-415" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-416" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.043em; padding-bottom: 0.333em;">⋅</span></span><span id="MJXc-Node-417" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.905em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.694em; top: -1.598em;"><span id="MJXc-Node-418" class="mjx-mrow" style=""><span id="MJXc-Node-419" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-420" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-421" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-422" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-423" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.694em; bottom: -0.628em;"><span id="MJXc-Node-424" class="mjx-mrow" style=""><span id="MJXc-Node-425" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-426" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.905em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-282">\frac{\partial L(\theta)}{\partial W} = \frac{\partial Y}{\partial W}\frac{\partial L(\theta)}{\partial Y} = X^T \cdot \frac{\partial L(\theta)}{\partial Y}</script></span>
<ul>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-283-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-427" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-428" class="mjx-mrow"><span id="MJXc-Node-429" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.905em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.694em; top: -1.598em;"><span id="MJXc-Node-430" class="mjx-mrow" style=""><span id="MJXc-Node-431" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-432" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span><span id="MJXc-Node-433" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-434" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.291em;">θ</span></span><span id="MJXc-Node-435" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.694em; bottom: -0.628em;"><span id="MJXc-Node-436" class="mjx-mrow" style=""><span id="MJXc-Node-437" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-438" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.905em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-283">\frac{\partial L(\theta)}{\partial Y}</script></span><span> 即為後面傳回來的 gradient </span><code>prev_grad</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul><h4 id="Training-Dataset" data-id="Training-Dataset"><a class="anchor hidden-xs" href="#Training-Dataset" title="Training-Dataset"><span class="octicon octicon-link"></span></a><span>Training Dataset</span></h4><p><img src="https://i.imgur.com/nviPTZ4.png" alt=""></p><ul>
<li><span>Left: A set of linearly seperatable data. Easy</span></li>
<li><span>Right: XOR data, which is a little more difficult to train</span></li>
</ul><h5 id="Linear-data" data-id="Linear-data"><a class="anchor hidden-xs" href="#Linear-data" title="Linear-data"><span class="octicon octicon-link"></span></a><span>Linear data</span></h5><ul>
<li><span>預設訓練 </span><code>10000</code><span> 次</span><pre><code class="python hljs">data_x, data_y = generate_linear(n=<span class="hljs-number">100</span>)
pred_y, loss_list = run_Net(data_x,data_y)

<span class="hljs-comment"># Comparison graph</span>
show_result(data_x,data_y,pred_y)
</code></pre>
<img src="https://i.imgur.com/o4j4FrN.png" alt=""></li>
</ul><h5 id="XOR-data" data-id="XOR-data"><a class="anchor hidden-xs" href="#XOR-data" title="XOR-data"><span class="octicon octicon-link"></span></a><span>XOR data</span></h5><ul>
<li><span>由於 XOR 較難訓練且資料不多，索性訓練 </span><code>500000</code><span> 次</span></li>
</ul><pre><code class="python hljs">data_x, data_y = generate_XOR_easy()
pred_y, loss_list = run_Net(data_x,data_y,\
                num_epochs = <span class="hljs-number">500000</span>, print_freq = <span class="hljs-number">10000</span>)
show_result(data_x,data_y,pred_y)s
</code></pre><p><img src="https://i.imgur.com/PSQQyxb.png" alt=""></p><h3 id="Prediction-Accuracy" data-id="Prediction-Accuracy"><a class="anchor hidden-xs" href="#Prediction-Accuracy" title="Prediction-Accuracy"><span class="octicon octicon-link"></span></a><span>Prediction Accuracy</span></h3><ul>
<li>
<p><span>計算方法:</span></p>
<ul>
<li><span>由於我們的 neural network 的輸出未必為整數，所以簡單以 </span><code>0.5</code><span> 為分界: 大於 </span><code>0.5</code><span> 就算 </span><code>1</code><span>, 小於 </span><code>0.5</code><span> 就算 </span><code>0</code><span>; 簡單粗暴</span></li>
<li><span>程式碼:</span></li>
</ul>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">acc</span><span class="hljs-params">(ground_truth, y)</span>:</span>
    <span class="hljs-keyword">print</span> (<span class="hljs-string">'Accuracy = '</span>,<span class="hljs-number">100</span>* (ground_truth[ground_truth==y].size / ground_truth.size) , <span class="hljs-string">'%'</span>)
</code></pre>
</li>
<li>
<p><span>Linear data accuracy</span><br>
<img src="https://i.imgur.com/nHGT4K0.png" alt=""></p>
</li>
<li>
<p><span>XOR data accuracy</span><br>
<img src="https://i.imgur.com/uiuhiii.png" alt=""></p>
</li>
</ul><h3 id="Learning-curves" data-id="Learning-curves"><a class="anchor hidden-xs" href="#Learning-curves" title="Learning-curves"><span class="octicon octicon-link"></span></a><span>Learning curves</span></h3><h4 id="lossepoch-curve" data-id="lossepoch-curve"><a class="anchor hidden-xs" href="#lossepoch-curve" title="lossepoch-curve"><span class="octicon octicon-link"></span></a><span>loss/epoch curve</span></h4><ul>
<li>
<p><span>透過 loss 對 epoch 做的 curve, 我們可以觀察訓練過程中, loss function 收斂的情況</span></p>
</li>
<li>
<p><span>Linear data</span><br>
<img src="https://i.imgur.com/j3VeakL.png" alt="" width="400" height="400"></p>
</li>
<li>
<p><span>XOR data</span><br>
<img src="https://i.imgur.com/CrhOHzv.png" alt="" width="400" height="400"></p>
</li>
<li>
<p><span>顯然，XOR 需要更多的 epochs 來使loss 收斂, 這大致上表示 XOR dataset</span></p>
</li>
</ul><h2 id="Discussion" data-id="Discussion"><a class="anchor hidden-xs" href="#Discussion" title="Discussion"><span class="octicon octicon-link"></span></a><span>Discussion</span></h2><h3 id="Train-with-different-learning-rates" data-id="Train-with-different-learning-rates"><a class="anchor hidden-xs" href="#Train-with-different-learning-rates" title="Train-with-different-learning-rates"><span class="octicon octicon-link"></span></a><span>Train with different learning rates</span></h3><ul>
<li><span>The choose of learning rate is essential in training neural network</span></li>
<li><span>We will train with lr = </span><code>1</code><span>, </span><code>0.75</code><span>, </span><code>0.5</code><span>, </span><code>0.1</code><span>, </span><code>0.05</code><span>, </span><code>0.01</code><span>, and see how they affect the training process:</span>
<ul>
<li><span>此實驗以 linear data 為例</span><br>
<img src="https://i.imgur.com/Ef0aZdS.png" alt=""></li>
</ul>
</li>
<li><span>According to the figure above, when the learning rate is too small(for example, </span><code>0.01</code><span> in this case), the loss may not converge quick enough.</span></li>
</ul><h3 id="Train-with-different-numbers-of-hidden-units" data-id="Train-with-different-numbers-of-hidden-units"><a class="anchor hidden-xs" href="#Train-with-different-numbers-of-hidden-units" title="Train-with-different-numbers-of-hidden-units"><span class="octicon octicon-link"></span></a><span>Train with different numbers of hidden units</span></h3><ul>
<li><span>上述的實驗皆僅用了 </span><code>2</code><span> 層 </span><code>4</code><span> units 的 hidden layers</span></li>
<li><span>接下來我們嘗試不同的 hidden layer units 數來訓練,觀察其對訓練過程的影響</span></li>
<li><span>Linear data</span><br>
<img src="https://i.imgur.com/2cW8M6c.png" alt="">
<ul>
<li><span>可以看到, 雖然增加到 </span><code>6</code><span> 或 </span><code>8</code><span> units 可以加快收斂速度, 但並不是越多越好. 一個可能的原因是題目太簡單, </span><mark><span>使用 capacity 較高的 model, 反而可能要花更多時間達到收斂</span></mark></li>
</ul>
</li>
</ul><h3 id="Train-without-sigmoid-function" data-id="Train-without-sigmoid-function"><a class="anchor hidden-xs" href="#Train-without-sigmoid-function" title="Train-without-sigmoid-function"><span class="octicon octicon-link"></span></a><span>Train without sigmoid function</span></h3><ul>
<li><span>在課堂中及 </span><a href="https://www.deeplearningbook.org/" target="_blank" rel="noopener"><em><strong><span>Deep Learning</span></strong></em></a><span>,  </span><strong><span>Goodfellow et-al.</span></strong><span> 書中皆有提到, neural network 的強大, 有一部份是來自於 activation function 能 fit nonlinear function; 若把 activation function 移除, 則神經網路只能學到 </span><strong><span>linear function</span></strong><span>; 這裡我們就試著把 sigmoid 層拿到, 來檢驗是否如此</span></li>
<li><span>程式碼</span></li>
</ul><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TLNN</span><span class="hljs-params">(object)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, layer_1_units = <span class="hljs-number">4</span>, layer_2_units = <span class="hljs-number">4</span>, bias= True)</span>:</span>
        self.layers = OrderedDict()
        self.layers[<span class="hljs-string">'linear_1'</span>] = Linear(<span class="hljs-number">2</span>,layer_1_units,bias=bias)
        <span class="hljs-comment">#self.layers['sigmoid_1'] = Sigmoid()</span>
        self.layers[<span class="hljs-string">'linear_2'</span>] = Linear(layer_1_units,layer_2_units,bias=bias)
        <span class="hljs-comment">#self.layers['sigmoid_2'] = Sigmoid()</span>
        self.layers[<span class="hljs-string">'output'</span>] = Linear(layer_2_units,<span class="hljs-number">1</span>,bias = <span class="hljs-keyword">False</span>)
        self.layers[<span class="hljs-string">'sigmoid_3'</span>] = Sigmoid()
        
        self.loss_func = MSE()
        ...
</code></pre><ul>
<li>
<p><span>我們留下了最後一層的 sigmoid function, 否則似乎會變成無法更新 weight: 剛開始訓練就出現 loss 為 </span><code>nan</code><span> 的情況</span></p>
</li>
<li>
<p><span>Training result - First Try</span></p>
<ul>
<li><span>使用各 </span><code>6</code><span> 個 hidden units 來訓練</span><br>
<img src="https://i.imgur.com/fHyPkc5.png" alt="">
<ul>
<li><s><span>由於我們使用 MSE 作為 loss function, 在計算的時候出現了 overflow, 導致輸出為 </span><code>0</code></s></li>
</ul>
</li>
</ul>
</li>
<li>
<p><span>Training result - Second Try</span><br>
<img src="https://i.imgur.com/L7kWzHC.png" alt="" width="500" height="350"></p>
<ul>
<li><span>顯然, 即使我們訓練了 </span><code>500000</code><span> 次, 仍不見我們的神經網路有"學到東西"</span></li>
<li><span>總結第一次沒成功的原因, 應該是 batch size 過大, 導致 MSE 計算產生 </span><a href="https://en.wikipedia.org/wiki/Integer_overflow" target="_blank" rel="noopener"><span>overflow</span></a><span> (雖然我們只設定 batch size = </span><code>20</code><span>)</span></li>
</ul>
</li>
</ul><h3 id="Train-with-different-loss-functions" data-id="Train-with-different-loss-functions"><a class="anchor hidden-xs" href="#Train-with-different-loss-functions" title="Train-with-different-loss-functions"><span class="octicon octicon-link"></span></a><span>Train with different loss functions</span></h3><ul>
<li>
<p><span>Cross-Entropy</span></p>
<blockquote>
<p><span>In information theory, the </span><em><strong><span>cross entropy</span></strong></em><span> between two probability distributions </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-284-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><span id="MJXc-Node-439" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-440" class="mjx-mrow"><span id="MJXc-Node-441" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-284">p</script></span><span> and </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-285-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><span id="MJXc-Node-442" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-443" class="mjx-mrow"><span id="MJXc-Node-444" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-285">q</script></span><span> over the same underlying set of events measures the </span><mark><span>average number of bits needed to identify an event drawn from the set</span></mark><span> if a coding scheme used for the set is optimized for an estimated probability distribution </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-286-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><span id="MJXc-Node-445" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-446" class="mjx-mrow"><span id="MJXc-Node-447" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-286">q</script></span><span>, rather than the true distribution </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-287-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><span id="MJXc-Node-448" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-449" class="mjx-mrow"><span id="MJXc-Node-450" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-287">p</script></span><span>.</span><br>
<span>The cross entropy of the distribution </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-288-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><span id="MJXc-Node-451" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-452" class="mjx-mrow"><span id="MJXc-Node-453" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.014em;">q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-288">q</script></span><span> relative to a distribution </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-289-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><span id="MJXc-Node-454" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-455" class="mjx-mrow"><span id="MJXc-Node-456" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-289">p</script></span><span> over a given set is defined as follows:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-290-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 119%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><msub><mi>E</mi><mi>p</mi></msub><mo stretchy=&quot;false&quot;>[</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>q</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span id="MJXc-Node-457" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-458" class="mjx-mrow"><span id="MJXc-Node-459" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-460" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-461" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em;">p</span></span><span id="MJXc-Node-462" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-463" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-464" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-465" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-466" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-467" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.026em;"><span id="MJXc-Node-468" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.026em;">E</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-469" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em;">p</span></span></span></span><span id="MJXc-Node-470" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-471" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.528em;">log</span></span><span id="MJXc-Node-472" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-473" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-474" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><msub><mi>E</mi><mi>p</mi></msub><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>q</mi><mo stretchy="false">]</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-290">H(p,q) = -E_p[\log q]</script></span></p>
<p><span>–</span><em><a href="https://en.wikipedia.org/wiki/Cross_entropy" target="_blank" rel="noopener"><span>Wikipedia</span></a></em></p>
</blockquote>
<ul>
<li><span>建議搭配 softmax 作為 output function 服用; Binary cross-entropy 則適合搭配</span><s><span>溫開水</span></s><span> sigmoid output function</span></li>
</ul>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Binary_Cross_Entropy</span><span class="hljs-params">(Layer)</span>:</span>    
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
    self.y = <span class="hljs-keyword">None</span>
    self.ground_truth = <span class="hljs-keyword">None</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">forward</span><span class="hljs-params">(self, y, ground_truth)</span>:</span>
    <span class="hljs-comment"># 使此 function 可以處理 batch ,也可以處理 single data</span>
    <span class="hljs-keyword">if</span> y.ndim == <span class="hljs-number">1</span>:
        ground_truth = ground_truth.reshape(<span class="hljs-number">1</span>, ground_truth.size)
        y = y.reshape(<span class="hljs-number">1</span>, y.size)
        
    batch_size = y.shape[<span class="hljs-number">0</span>]
    self.y = y
    self.ground_truth = ground_truth
    
    <span class="hljs-comment"># To avoid -inf; 重要！！</span>
    delta = <span class="hljs-number">1e-7</span> 
    
    <span class="hljs-keyword">return</span> (<span class="hljs-number">-1</span>/ batch_size)*np.sum(self.ground_truth * np.log2(self.y + delta) + (<span class="hljs-number">1</span>-self.ground_truth) * np.log2(<span class="hljs-number">1</span> - self.y + delta))

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">backward</span><span class="hljs-params">(self,prev_grad=<span class="hljs-number">1</span>,lr=<span class="hljs-number">0.1</span>)</span>:</span>
    <span class="hljs-string">'''
        prev_grad, lr: pseudo parameters
    '''</span>
    batch_size = self.y.shape[<span class="hljs-number">0</span>]
    
    <span class="hljs-comment"># To avoid -inf; </span>
    delta = <span class="hljs-number">1e-7</span> 
    dx = - (np.divide(self.ground_truth, self.y + delta) - np.divide(<span class="hljs-number">1</span> - self.ground_truth, <span class="hljs-number">1</span> - self.y - delta))
    <span class="hljs-keyword">return</span> dx
</code></pre>
<ul>
<li><span>實驗設定</span>
<ul>
<li><span>Dataset: XOR data</span></li>
<li><span>Activation function: </span><code>sigmoid()</code></li>
<li><span>Loss function : Binary cross-entropy</span></li>
</ul>
</li>
<li><span>實驗結果</span><br>
<img src="https://i.imgur.com/rVmn58Y.png" alt="" width="300" height="300"><img src="https://i.imgur.com/6aVXXmH.png" alt="" width="320" height="320">
<ul>
<li><span>左圖是以 MSE 作為 loss function; 而右圖則是以 binary cross-entropy 作為 loss function</span></li>
<li><span>可以見到兩個的收斂範圍都在 </span><code>100000</code><span> 次左右達到穩定,</span></li>
</ul>
</li>
</ul>
</li>
</ul><h3 id="Train-with-different-activation-function" data-id="Train-with-different-activation-function"><a class="anchor hidden-xs" href="#Train-with-different-activation-function" title="Train-with-different-activation-function"><span class="octicon octicon-link"></span></a><span>Train with different activation function</span></h3><ul>
<li><span>ReLU</span>
<ul>
<li><span>A simple function : </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-291-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-475" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-476" class="mjx-mrow"><span id="MJXc-Node-477" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.498em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-478" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-479" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-480" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span><span id="MJXc-Node-481" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-482" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.167em; padding-bottom: 0.333em;">max</span></span><span id="MJXc-Node-483" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-484" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.374em;">0</span></span><span id="MJXc-Node-485" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.539em;">,</span></span><span id="MJXc-Node-486" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-487" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-291">f(x) = \max(0,x)</script></span></li>
<li><span>其微分為 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-292-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn><mo>,</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;gt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo><mtext>&amp;#xA0;</mtext><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></math>" role="presentation"><span id="MJXc-Node-488" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-489" class="mjx-mrow"><span id="MJXc-Node-490" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.885em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.666em; top: -1.598em;"><span id="MJXc-Node-491" class="mjx-mrow" style=""><span id="MJXc-Node-492" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-493" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.498em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-494" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-495" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-496" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.666em; bottom: -0.628em;"><span id="MJXc-Node-497" class="mjx-mrow" style=""><span id="MJXc-Node-498" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-499" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.885em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.444em;" class="mjx-vsize"></span></span><span id="MJXc-Node-500" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-501" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-502" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.242em; padding-bottom: 1.242em;">{</span></span><span id="MJXc-Node-503" class="mjx-mtable" style="vertical-align: -0.997em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-504" class="mjx-mtr" style="height: 1.275em;"><span id="MJXc-Node-505" class="mjx-mtd" style="padding: 0px; text-align: left; width: 5.314em;"><span id="MJXc-Node-506" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-507" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.333em;">1</span></span><span id="MJXc-Node-508" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.539em;">,</span></span><span id="MJXc-Node-509" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.287em; padding-bottom: 0.333em;">&nbsp;</span></span><span id="MJXc-Node-510" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.498em; padding-bottom: 0.498em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-511" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-512" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">x</span></span><span id="MJXc-Node-513" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span><span id="MJXc-Node-514" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.25em; padding-bottom: 0.374em;">&gt;</span></span><span id="MJXc-Node-515" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.374em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-516" class="mjx-mtr" style="height: 1.219em;"><span id="MJXc-Node-517" class="mjx-mtd" style="padding: 0.2em 0px 0px; text-align: left;"><span id="MJXc-Node-518" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-519" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.374em;">0</span></span><span id="MJXc-Node-520" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.539em;">,</span></span><span id="MJXc-Node-521" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.287em; padding-bottom: 0.333em;">&nbsp;</span></span><span id="MJXc-Node-522" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.333em;">otherwise</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-523" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn><mo>,</mo><mtext>&nbsp;</mtext><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo><mtext>&nbsp;</mtext><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-292">\frac{\partial f(x)}{\partial x}=\left\{
  \begin{array}{l}
   1,\ f(x) > 0\\
   0,\ \text{otherwise}
  \end{array}
\right.</script></span></li>
<li><span>程式碼實做</span></li>
</ul>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReLU</span><span class="hljs-params">(Layer)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
        self.mask = <span class="hljs-keyword">None</span>
        self.y = <span class="hljs-keyword">None</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">forward</span><span class="hljs-params">(self, x)</span>:</span>
        self.mask = (x &lt;= <span class="hljs-number">0</span>)
        self.y = x.copy()
        self.y[self.mask] = <span class="hljs-number">0</span>
        <span class="hljs-keyword">return</span> self.y

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">backward</span><span class="hljs-params">(self, prev_grad,lr=<span class="hljs-number">0.1</span>)</span>:</span>
        <span class="hljs-comment"># Return prev_grad * derivative of sigmoid func.</span>
        grad = prev_grad
        grad[self.mask] = <span class="hljs-number">0</span>
        <span class="hljs-keyword">return</span> grad
</code></pre>
<ul>
<li><span>實驗設定</span>
<ul>
<li><span>Dataset: XOR data</span></li>
<li><span>Activation function: </span><code>ReLU()</code></li>
<li><span>Loss function : Mean square error</span></li>
</ul>
</li>
<li><span>實驗結果</span><br>
<img src="https://i.imgur.com/pu81RN6.png" alt="" width="400" height="300"><img src="https://i.imgur.com/VJy4bSO.png" alt="" width="400" height="300"></li>
<li><span>從圖中我們可以很明顯地發現, 使用 </span><code>ReLU</code><span> function 在這個條件下, loss function 的收斂速度確實較快</span></li>
</ul>
</li>
</ul><h4 id="Train-with-ReLU-amp-Binary-Cross-Entropy" data-id="Train-with-ReLU-amp-Binary-Cross-Entropy"><a class="anchor hidden-xs" href="#Train-with-ReLU-amp-Binary-Cross-Entropy" title="Train-with-ReLU-amp-Binary-Cross-Entropy"><span class="octicon octicon-link"></span></a><span>Train with ReLU &amp; Binary Cross-Entropy</span></h4><ul>
<li><span>接著, 我們把 activation function 跟 loss function 都換掉試試看</span></li>
<li><span>實驗設定</span>
<ul>
<li><span>Dataset: XOR data</span></li>
<li><span>Activation function: </span><code>ReLU()</code></li>
<li><span>Loss function : Binary cross-entropy</span></li>
<li><mark><span>Learning rate: 0.01</span></mark></li>
</ul>
</li>
<li><span>第一次實驗結果</span><br>
<img src="https://i.imgur.com/uFejL4X.png" alt="" width="400" height="300">
<ul>
<li><span>未達收斂！</span></li>
<li><span>分析原因: 即使視同一個 dataset, 不同的 loss function, 適用的 learning rate 可能也不同. 可能因此而導致 model 訓練未果</span></li>
<li><span>進行第二次實驗</span></li>
</ul>
</li>
<li><span>第二次實驗設定</span><br>
<span>* Dataset: XOR data</span><br>
<span>* Activation function: </span><code>ReLU()</code><br>
<span>* Loss function : Binary cross-entropy</span><br>
<span>* </span><mark><span>Learning rate: 0.001</span></mark></li>
<li><span>第二次實驗結果</span><br>
<img src="https://i.imgur.com/fWnTsOp.png" alt="" width="400" height="300">
<ul>
<li><span>結果非常成功</span></li>
<li><span>由此實驗可知, learning rate 的調整是非常值得注意的環節; 這可能也是 optimizer 值得研究的原因之一</span></li>
</ul>
</li>
</ul><h3 id="Bonus-Train-with-Different-Learning-Rate-II" data-id="Bonus-Train-with-Different-Learning-Rate-II"><a class="anchor hidden-xs" href="#Bonus-Train-with-Different-Learning-Rate-II" title="Bonus-Train-with-Different-Learning-Rate-II"><span class="octicon octicon-link"></span></a><span>Bonus: Train with Different Learning Rate (II)</span></h3><ul>
<li>
<p><span>由於在上個實驗中, learning rate 確實扮演了重要的角色, 所以再度做了跟 learning rate 有關的實驗</span></p>
</li>
<li>
<p><span>我們手動調整 learning rate 的值, 希望找到接近發散與收斂的臨界值</span></p>
</li>
<li>
<p><span>實驗設定 (I)</span></p>
<ul>
<li><span>Dataset: XOR data</span></li>
<li><span>Activation function: </span><code>ReLU()</code></li>
<li><span>Loss function : Binary cross-entropy</span></li>
<li><mark><span>Learning rate: 0.001490625</span></mark></li>
</ul>
</li>
<li>
<p><span>實驗結果 (I)</span><br>
<img src="https://i.imgur.com/1mN9nLH.png" alt=""></p>
<ul>
<li><span>可以見到 loss 成功收斂, 沒有問題</span></li>
</ul>
</li>
<li>
<p><span>實驗設定 (II)</span></p>
<ul>
<li><span>Dataset: XOR data</span></li>
<li><span>Activation function: </span><code>ReLU()</code></li>
<li><span>Loss function : Binary cross-entropy</span></li>
<li><mark><span>Learning rate: 0.001490626</span></mark></li>
</ul>
</li>
<li>
<p><span>實驗結果 (II)</span><br>
<img src="https://i.imgur.com/ffSdP3v.png" alt=""></p>
<ul>
<li><span>重複做了幾次, 也改變了 random seed, 但當 learning rate 增加 </span><code>1e-9</code><span>, 結果卻大不相同</span></li>
<li><span>猜測原因大概就是</span><a href="https://hackmd.io/@sysprog/c-floating-point" target="_blank" rel="noopener"><span>浮點數的限制</span></a></li>
<li><span>正因如此, 進行 neural network 實做的我們, 才更應該掌握這些計算機架構的背景知識, 以免徒耗心力</span></li>
<li><span>相關連結：</span><a href="https://hackmd.io/@sysprog/software-failure" target="_blank" rel="noopener"><span>軟體缺失導致的危害</span></a></li>
</ul>
</li>
</ul><h3 id="Problem-Discussions" data-id="Problem-Discussions"><a class="anchor hidden-xs" href="#Problem-Discussions" title="Problem-Discussions"><span class="octicon octicon-link"></span></a><span>Problem Discussions</span></h3><h4 id="Input-amp-output-dimension" data-id="Input-amp-output-dimension"><a class="anchor hidden-xs" href="#Input-amp-output-dimension" title="Input-amp-output-dimension"><span class="octicon octicon-link"></span></a><span>Input &amp; output dimension</span></h4><ul>
<li><span>一開始定義 Linear layer 的時候，我用的是 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-321-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mi>W</mi><mi>X</mi><mo>+</mo><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-724" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-725" class="mjx-mrow"><span id="MJXc-Node-726" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.498em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-727" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-728" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-729" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-730" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">+</span></span><span id="MJXc-Node-731" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>W</mi><mi>X</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-321">y = WX + b</script></span><span> 的形式</span>
<ul>
<li><span>在計算 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-322-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>W</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-732" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-733" class="mjx-mrow"><span id="MJXc-Node-734" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.283em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.814em; top: -1.335em;"><span id="MJXc-Node-735" class="mjx-mrow" style=""><span id="MJXc-Node-736" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-737" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.814em; bottom: -0.628em;"><span id="MJXc-Node-738" class="mjx-mrow" style=""><span id="MJXc-Node-739" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-740" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.104em;">W</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.283em;" class="mjx-line"></span></span><span style="height: 1.388em; vertical-align: -0.444em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>W</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-322">\frac{\partial L}{\partial W}</script></span><span> 時，結果將會是 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-323-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>y</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><msup><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup></math>" role="presentation"><span id="MJXc-Node-741" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-742" class="mjx-mrow"><span id="MJXc-Node-743" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.023em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.447em; top: -1.335em;"><span id="MJXc-Node-744" class="mjx-mrow" style=""><span id="MJXc-Node-745" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-746" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.447em; bottom: -0.811em;"><span id="MJXc-Node-747" class="mjx-mrow" style=""><span id="MJXc-Node-748" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-749" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.498em; padding-right: 0.006em;">y</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.023em;" class="mjx-line"></span></span><span style="height: 1.517em; vertical-align: -0.573em;" class="mjx-vsize"></span></span><span id="MJXc-Node-750" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.043em; padding-bottom: 0.333em;">⋅</span></span><span id="MJXc-Node-751" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-752" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-753" class="mjx-texatom" style=""><span id="MJXc-Node-754" class="mjx-mrow"><span id="MJXc-Node-755" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>⋅</mo><msup><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-323">\frac{\partial L}{\partial y} \cdot X^{T}</script></span></li>
<li><span>但當 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-324-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-756" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-757" class="mjx-mrow"><span id="MJXc-Node-758" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-324">X</script></span><span> 是長度為 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-325-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span id="MJXc-Node-759" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-760" class="mjx-mrow"><span id="MJXc-Node-761" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">n</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-325">n</script></span><span> 的vector, numpy 不會將其轉為 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-326-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-762" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-763" class="mjx-mrow"><span id="MJXc-Node-764" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-765" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.333em;">1</span></span><span id="MJXc-Node-766" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.539em;">,</span></span><span id="MJXc-Node-767" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.291em;">n</span></span><span id="MJXc-Node-768" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-326">(1,n)</script></span><span> 的 matrix, 而是保留原長度</span></li>
<li><span>解決方法:</span>
<ol>
<li><span>可以透過判斷 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-327-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-769" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-770" class="mjx-mrow"><span id="MJXc-Node-771" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-327">X</script></span><span> 的 shape 並手動更改</span></li>
<li><span>將上述式子改為 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-328-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-772" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-773" class="mjx-mrow"><span id="MJXc-Node-774" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.498em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-775" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-776" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-777" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-778" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">+</span></span><span id="MJXc-Node-779" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-328">y = XW + b</script></span><span>, 並計算 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-329-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>y</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><msup><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup></math>" role="presentation"><span id="MJXc-Node-780" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-781" class="mjx-mrow"><span id="MJXc-Node-782" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.023em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.447em; top: -1.335em;"><span id="MJXc-Node-783" class="mjx-mrow" style=""><span id="MJXc-Node-784" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-785" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.447em; bottom: -0.811em;"><span id="MJXc-Node-786" class="mjx-mrow" style=""><span id="MJXc-Node-787" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.374em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-788" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.498em; padding-right: 0.006em;">y</span></span></span></span><span style="border-bottom: 1.5px solid; top: -0.28em; width: 1.023em;" class="mjx-line"></span></span><span style="height: 1.517em; vertical-align: -0.573em;" class="mjx-vsize"></span></span><span id="MJXc-Node-789" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.043em; padding-bottom: 0.333em;">⋅</span></span><span id="MJXc-Node-790" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-791" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-792" class="mjx-texatom" style=""><span id="MJXc-Node-793" class="mjx-mrow"><span id="MJXc-Node-794" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>⋅</mo><msup><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-329">\frac{\partial L}{\partial y} \cdot X^{T}</script></span><span>的結果</span>
<ul>
<li><span>Pros: 可以無須對 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-330-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-795" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-796" class="mjx-mrow"><span id="MJXc-Node-797" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-330">X</script></span><span> 作轉置，且為通常使用的方法</span></li>
<li><span>Cons: 跟 Lineaer Algebra 通常把 input 放後面的寫法不一樣了，個人私心不想這麼做(最後妥協了ˊˋ)</span></li>
</ul>
</li>
<li><mark><span>直接改為丟 mini batch 進去</span></mark>
<ul>
<li><span>雖然成功解決了 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-331-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-798" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-799" class="mjx-mrow"><span id="MJXc-Node-800" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-331">X</script></span><span> 為 vector 無法轉置的問題(因為變成 matrix 了)，但後續在計算 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-332-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mi>W</mi><mi>X</mi><mo>+</mo><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-801" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-802" class="mjx-mrow"><span id="MJXc-Node-803" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.209em; padding-bottom: 0.498em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-804" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-805" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-806" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-807" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">+</span></span><span id="MJXc-Node-808" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>W</mi><mi>X</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-332">y = WX + b</script></span><span> 時, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-333-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-809" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-810" class="mjx-mrow"><span id="MJXc-Node-811" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.457em; padding-bottom: 0.291em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-333">b</script></span><span> 也遇到了相同的情形，而無法做 </span><a href="https://numpy.org/doc/stable/user/basics.broadcasting.html" target="_blank" rel="noopener"><span>broadcast 加法</span></a></li>
<li><span>結果: 放棄，改用上述 2. 的作法</span></li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul><h4 id="RuntimeWarning-invalid-value-encountered-in-log2" data-id="RuntimeWarning-invalid-value-encountered-in-log2"><a class="anchor hidden-xs" href="#RuntimeWarning-invalid-value-encountered-in-log2" title="RuntimeWarning-invalid-value-encountered-in-log2"><span class="octicon octicon-link"></span></a><span>RuntimeWarning: invalid value encountered in log2</span></h4><ul>
<li>
<p><span>發生在以 </span><code>ReLU</code><span> 作為 output function, binary cross-entropy 時產生的</span></p>
<ul>
<li>
<p><code>ReLU</code><span> 是一種 activation function, 並非用來當作 output function 使用</span></p>
<ul>
<li><span>原因： Output function 通常是根據問題的類別來定義的. 如：學習 </span><a href="https://en.wikipedia.org/wiki/Bernoulli_distribution" target="_blank" rel="noopener"><span>Bernoulli distrubution</span></a><span>(二元分類問題) 的 model 通常以 </span><code>sigmoid</code><span> 或 </span><code>tanh</code><span> 作為 output function, 因為 ground truth 為 </span><code>0</code><span> 或 </span><code>1</code><span>; 而 </span><a href="https://en.wikipedia.org/wiki/Categorical_distribution" target="_blank" rel="noopener"><span>Multinoulli Distribution</span></a><span> 則常用 </span><code>softmax</code><span> 作為 output function</span></li>
</ul>
</li>
<li>
<p><code>np.log2</code><span> 的 input 值必須大於 </span><code>0</code><span>. 摁, 國中數學,但被我忘了</span></p>
</li>
</ul>
</li>
<li>
<p><span>解決方法: 用 </span><code>sigmoid</code><span> 作為 output function, 只改變 hidden layer 的 activation function 為 </span><code>ReLU</code></p>
</li>
<li>
<p><span>另外, 由於 </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-334-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 126%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>log</mi><mn>2</mn></msub><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></math>" role="presentation"><span id="MJXc-Node-812" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-813" class="mjx-mrow"><span id="MJXc-Node-814" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-815" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.415em; padding-bottom: 0.539em;">log</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.377em; padding-right: 0.071em;"><span id="MJXc-Node-816" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.333em;">2</span></span></span></span><span id="MJXc-Node-817" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-818" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">(</span></span><span id="MJXc-Node-819" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.374em; padding-bottom: 0.374em;">0</span></span><span id="MJXc-Node-820" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.457em; padding-bottom: 0.581em;">)</span></span><span id="MJXc-Node-821" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.085em; padding-bottom: 0.333em;">=</span></span><span id="MJXc-Node-822" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.291em; padding-bottom: 0.415em;">−</span></span><span id="MJXc-Node-823" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.167em; padding-bottom: 0.333em;">∞</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>log</mi><mn>2</mn></msub><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-334">\log_2(0) = -\infty</script></span><span>, 所以實做時, 記得加上一個 </span><code>delta=1e-7</code><span> 來避免這種情況的產生</span></p>
</li>
</ul></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Lab1--Back-propagation" title="Lab1 : Back-propagation">Lab1 : Back-propagation</a><ul class="nav">
<li><a href="#Introduction" title="Introduction">Introduction</a><ul class="nav">
<li><a href="#Lab-Objective" title="Lab Objective">Lab Objective</a></li>
<li><a href="#Requirements" title="Requirements">Requirements</a></li>
</ul>
</li>
<li><a href="#Experiment-Setups" title="Experiment Setups">Experiment Setups</a><ul class="nav">
<li><a href="#Sigmoid-functions" title="Sigmoid functions">Sigmoid functions</a></li>
<li><a href="#Neural-network" title="Neural network">Neural network</a></li>
<li><a href="#Backpropagation" title="Backpropagation">Backpropagation</a></li>
<li><a href="#Prediction-Accuracy" title="Prediction Accuracy">Prediction Accuracy</a></li>
<li><a href="#Learning-curves" title="Learning curves">Learning curves</a></li>
</ul>
</li>
<li><a href="#Discussion" title="Discussion">Discussion</a><ul class="nav">
<li><a href="#Train-with-different-learning-rates" title="Train with different learning rates">Train with different learning rates</a></li>
<li><a href="#Train-with-different-numbers-of-hidden-units" title="Train with different numbers of hidden units">Train with different numbers of hidden units</a></li>
<li><a href="#Train-without-sigmoid-function" title="Train without sigmoid function">Train without sigmoid function</a></li>
<li><a href="#Train-with-different-loss-functions" title="Train with different loss functions">Train with different loss functions</a></li>
<li><a href="#Train-with-different-activation-function" title="Train with different activation function">Train with different activation function</a></li>
<li><a href="#Bonus-Train-with-Different-Learning-Rate-II" title="Bonus: Train with Different Learning Rate (II)">Bonus: Train with Different Learning Rate (II)</a></li>
<li><a href="#Problem-Discussions" title="Problem Discussions">Problem Discussions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Lab1--Back-propagation" title="Lab1 : Back-propagation">Lab1 : Back-propagation</a><ul class="nav">
<li><a href="#Introduction" title="Introduction">Introduction</a><ul class="nav">
<li><a href="#Lab-Objective" title="Lab Objective">Lab Objective</a></li>
<li><a href="#Requirements" title="Requirements">Requirements</a></li>
</ul>
</li>
<li class=""><a href="#Experiment-Setups" title="Experiment Setups">Experiment Setups</a><ul class="nav">
<li><a href="#Sigmoid-functions" title="Sigmoid functions">Sigmoid functions</a></li>
<li class=""><a href="#Neural-network" title="Neural network">Neural network</a></li>
<li><a href="#Backpropagation" title="Backpropagation">Backpropagation</a></li>
<li><a href="#Prediction-Accuracy" title="Prediction Accuracy">Prediction Accuracy</a></li>
<li><a href="#Learning-curves" title="Learning curves">Learning curves</a></li>
</ul>
</li>
<li><a href="#Discussion" title="Discussion">Discussion</a><ul class="nav">
<li><a href="#Train-with-different-learning-rates" title="Train with different learning rates">Train with different learning rates</a></li>
<li><a href="#Train-with-different-numbers-of-hidden-units" title="Train with different numbers of hidden units">Train with different numbers of hidden units</a></li>
<li><a href="#Train-without-sigmoid-function" title="Train without sigmoid function">Train without sigmoid function</a></li>
<li><a href="#Train-with-different-loss-functions" title="Train with different loss functions">Train with different loss functions</a></li>
<li><a href="#Train-with-different-activation-function" title="Train with different activation function">Train with different activation function</a></li>
<li><a href="#Bonus-Train-with-Different-Learning-Rate-II" title="Bonus: Train with Different Learning Rate (II)">Bonus: Train with Different Learning Rate (II)</a></li>
<li><a href="#Problem-Discussions" title="Problem Discussions">Problem Discussions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
